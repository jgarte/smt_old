(in-package #:smt)
(ql:quickload "cl-fad")


((pathname-name "/home/amir/haydn/svg/haydn-23.svg"))

;;; https://common-lisp.net/project/cxml/quickstart.html
(defun resolver (pubid sysid)
  (declare (ignore pubid sysid))
  (flexi-streams:make-in-memory-input-stream nil))

(defun build-font (srcpath)
  ;; Prepare data
  (let* ((font-name (pathname-name srcpath))
	 (exportpath (format nil "/tmp/~Aexport/" font-name))
	 (bboxpath (format nil "/tmp/~A~A" font-name (string (gensym "bbox")))))
    (ensure-directories-exist exportpath)
    (sb-ext:run-program
     "/usr/bin/fontforge"
     (list "-script" "/home/amir/Work/Lisp/smt/build-font.ff"
    	   srcpath
	   ;; $2 Where glyphs are exported (directory)
	   (namestring exportpath)
	   ;; $3 Where bboxes are written to (file),
	   ;; this file will be created by Fontforge.
	   bboxpath))
    (with-open-file (bbox bboxpath)
      (loop for ln = (read-line bbox nil)
	    for trimln = (string-trim '(#\Space) ln)
	    for lst = (split-sequence:split-sequence
			   #\Space trimln
			   )
	    while (and ln (not (string= (car lst) "")))
	    collect (mapcar #'read-from-string lst))))
  )
(build-font "/home/amir/haydn/svg/haydn-23.svg")

(assoc 'clefs.g '((.NOTDEF 50 0 450 533) (.NOTDEF 50 0 450 533) (RESTS.0 0 -165 321 0)
   (RESTS.1 0 0 321 165) (RESTS.0O -97 -163 407.06 23)
   (RESTS.1O -94.0601 -21 410 165) (RESTS.M3 0 -250 450 250)
   (RESTS.M2 0 -250 150 250) (RESTS.M1 0 0 150 250) (RESTS.M1O -125 -25 275 275)
   (RESTS.2 -15.4528 -306.449 275.112 402.966)
   (RESTS.2CLASSICAL 0.4008 -274.761 275 214) (RESTS.3 -7 -274.761 267.599 214)
   (RESTS.4 -38.0004 -494.347 335.477 214) (RESTS.5 -62.0001 -494.347 368.1 481)
   (RESTS.6 -62 -758.476 389.607 465) (RESTS.7 -62.0001 -758.347 440.607 715)
   (ACCIDENTALS.SHARP -9.0e-5 -320.071 264 349.077)
   (ACCIDENTALS.SHARP.ARROWUP 0 -375 321 655)
   (ACCIDENTALS.SHARP.ARROWDOWN -46 -655 275 375)
   (ACCIDENTALS.SHARP.ARROWBOTH -46 -655 321 655)
   (ACCIDENTALS.SHARP.SLASHSLASH.STEM 0 -337 175 337)
   (ACCIDENTALS.SHARP.SLASHSLASHSLASH.STEMSTEM 0 -375 275 375)
   (ACCIDENTALS.SHARP.SLASHSLASHSLASH.STEM 0 -323 238 323)
   (ACCIDENTALS.SHARP.SLASHSLASH.STEMSTEMSTEM 0 -375 400 375)
   (ACCIDENTALS.NATURAL -3.16887 -434 170.759 449)
   (ACCIDENTALS.NATURAL.ARROWUP -110 -382 174 656)
   (ACCIDENTALS.NATURAL.ARROWDOWN -8 -656 277 382)
   (ACCIDENTALS.NATURAL.ARROWBOTH -110 -656 277 656)
   (ACCIDENTALS.FLAT -14 -167.778 186.097 431)
   (ACCIDENTALS.FLAT.ARROWUP -129 -163 200 656)
   (ACCIDENTALS.FLAT.ARROWDOWN -119 -529 200 465)
   (ACCIDENTALS.FLAT.ARROWBOTH -129 -529 200 656)
   (ACCIDENTALS.FLAT.SLASH -119 -163 200 465)
   (ACCIDENTALS.FLAT.SLASHSLASH -119 -163 200 465)
   (ACCIDENTALS.MIRROREDFLAT.FLAT -0.0968 -167.778 422.097 431)
   (ACCIDENTALS.MIRROREDFLAT -16.0968 -167.778 184 431)
   (ACCIDENTALS.MIRROREDFLAT.BACKSLASH -100 -163 219 465)
   (ACCIDENTALS.FLATFLAT -14 -167.778 369.097 431)
   (ACCIDENTALS.FLATFLAT.SLASH -146 -163 362 465)
   (ACCIDENTALS.DOUBLESHARP -16.3854 -163.276 273.44 147.052)
   (ACCIDENTALS.RIGHTPAREN 63.2113 -282.837 158 280.347)
   (ACCIDENTALS.LEFTPAREN -158 -280.348 -63.2112 282.837)
   (ARROWHEADS.OPEN.01 -250 -125 20 125) (ARROWHEADS.OPEN.0M1 -20 -125 250 125)
   (ARROWHEADS.OPEN.11 -125 -250 125 20) (ARROWHEADS.OPEN.1M1 -125 -20 125 250)
   (ARROWHEADS.CLOSE.01 -250 -125 10 125) (ARROWHEADS.CLOSE.0M1 -10 -125 250 125)
   (ARROWHEADS.CLOSE.11 -125 -250 125 10) (ARROWHEADS.CLOSE.1M1 -125 -10 125 250)
   (DOTS.DOT 0 -56 111 56) (SCRIPTS.UFERMATA -382 -16 390.875 407)
   (SCRIPTS.DFERMATA -390.875 -407 382 16)
   (SCRIPTS.USHORTFERMATA -256 0 274.736 564)
   (SCRIPTS.DSHORTFERMATA -274.736 -564 256 0)
   (SCRIPTS.ULONGFERMATA -301.306 -2.0e-4 300 356.24)
   (SCRIPTS.DLONGFERMATA -300 -356.24 301.306 2.0e-4)
   (SCRIPTS.UVERYLONGFERMATA -341.75 -0.0634737 340 441.966)
   (SCRIPTS.DVERYLONGFERMATA -340 -441.966 341.75 0.0634737)
   (SCRIPTS.THUMB -111 -201 111 124)
   (SCRIPTS.SFORZATO -284.499 -133.64 277 124.224)
   (SCRIPTS.ESPR -585 -135.224 589 124.224) (SCRIPTS.STACCATO -62 -62 62 62)
   (SCRIPTS.USTACCATISSIMO -52.3767 -15 52.2071 216.25)
   (SCRIPTS.DSTACCATISSIMO -52.3767 -216.25 52.2071 15)
   (SCRIPTS.TENUTO -180 -36 181.059 36) (SCRIPTS.UPORTATO -180 -36 181.059 226)
   (SCRIPTS.DPORTATO -181.059 -226 180 36)
   (SCRIPTS.UMARCATO -174 -3.55271e-15 160.287 388)
   (SCRIPTS.DMARCATO -160.287 -388 174 0) (SCRIPTS.OPEN -127 -138 127 138)
   (SCRIPTS.HALFOPEN -148.669 -184.073 150.416 185.741)
   (SCRIPTS.HALFOPENVERTICAL -127 -217.777 127 223.319)
   (SCRIPTS.STOPPED -145 -144.424 143.847 144.423)
   (SCRIPTS.UPBOW -135.31 0 139.309 502.209)
   (SCRIPTS.DOWNBOW -157.653 0 160 356.24)
   (SCRIPTS.REVERSETURN -251 -129 251 134) (SCRIPTS.TURN -251 -134 251 129)
   (SCRIPTS.TRILL -259.644 -10.2872 253 396.157)
   (SCRIPTS.UPEDALHEEL -162 -200.013 162 172.045)
   (SCRIPTS.DPEDALHEEL -162 -172.045 162 200.013)
   (SCRIPTS.UPEDALTOE -135.31 0.001064 139.309 380.001)
   (SCRIPTS.DPEDALTOE -139.309 -380.001 135.31 -0.001064)
   (SCRIPTS.FLAGEOLET -120 -118 120 122)
   (SCRIPTS.SEGNO -233.102 -324 219.036 322)
   (SCRIPTS.VARSEGNO -314 -1003 314 1003) (SCRIPTS.CODA -295.012 -295 290 290)
   (SCRIPTS.VARCODA -308 -312 308 304) (SCRIPTS.RCOMMA 0 -132.184 144 140)
   (SCRIPTS.LCOMMA -144 -140 0 132.184)
   (SCRIPTS.RVARCOMMA -87.9108 -183.177 92.1448 183.441)
   (SCRIPTS.LVARCOMMA -92.1449 -183.441 87.9109 183.177)
   (SCRIPTS.ARPEGGIO 24 -19.6531 172 269.588)
   (SCRIPTS.TRILL_ELEMENT 70.3469 25 359.588 173)
   (SCRIPTS.ARPEGGIO.ARROW.M1 -55.9921 11.4866 264.984 269.588)
   (SCRIPTS.ARPEGGIO.ARROW.1 -65.9843 -19.5877 254.992 238.513)
   (SCRIPTS.TRILELEMENT -121 -125 121 125)
   (SCRIPTS.PRALL -302.222 -112.859 320.401 120.081)
   (SCRIPTS.MORDENT -319.222 -181 303.401 180)
   (SCRIPTS.PRALLPRALL -423.226 -111.784 388.038 116.394)
   (SCRIPTS.PRALLMORDENT -424.526 -181 402.401 180)
   (SCRIPTS.UPPRALL -514.973 -288.83 388.038 116.394)
   (SCRIPTS.UPMORDENT -514.973 -288.83 402.401 180)
   (SCRIPTS.PRALLDOWN -423.226 -296.507 560.803 116.394)
   (SCRIPTS.DOWNPRALL -560.803 -116.394 423.226 296.507)
   (SCRIPTS.DOWNMORDENT -560.803 -214.628 423.226 296.506)
   (SCRIPTS.PRALLUP -388.038 -116.394 514.974 288.83)
   (SCRIPTS.LINEPRALL -426.23 -111.785 388.038 392.97)
   (SCRIPTS.CAESURA.CURVED 1.92076 -220.397 307.722 318.175)
   (SCRIPTS.CAESURA.STRAIGHT 9.44685 -197.902 406.566 311.907)
   (SCRIPTS.TICKMARK -130.755 -0.00347 280.884 367.642)
   (SCRIPTS.SNAPPIZZICATO -108 -106 108 211.642)
   (CLEFS.C -2.63826 -504.501 669 503.386)
   (CLEFS.C_CHANGE -2.11082 -403.6 535.2 402.709)
   (CLEFS.F -84.1666 -579.275 699 250) (CLEFS.F_CHANGE -7.96398 -465.612 589 235)
   (CLEFS.G -15.9997 -664 632 1114.43) (CLEFS.G_CHANGE -1.00088 -560 618 999.852)
   (CLEFS.PERCUSSION 166 -222 499 222) (CLEFS.PERCUSSION_CHANGE 133 -178 399 178)
   (CLEFS.TAB 45 -722 700 723) (CLEFS.TAB_CHANGE 36 -577 560 578)
   (TIMESIG.C44 0 -289 438.093 273) (TIMESIG.C22 0 -383 438.093 389)
   (PEDAL.* 0 0 428 427) (PEDAL.M -15.541 165.142 214.803 242.746)
   (PEDAL.. 0 0 85 85) (PEDAL.P 1.1e-4 -10.0437 442 504)
   (PEDAL.D -23.1044 -3.33e-4 290 406.809) (PEDAL.E -8.6825 0 211.53 264)
   (PEDAL.PED 0 -10.0441 832 504)
   (BRACKETTIPS.UP -5.0e-5 -55.0001 531.149 459.336)
   (BRACKETTIPS.DOWN 8.0e-5 -459.336 531.149 55)
   (ACCORDION.DISCANT -391 -11 391 761) (ACCORDION.DOT -62 -62 62 62)
   (ACCORDION.FREEBASS -266 -11 266 511) (ACCORDION.STDBASS -516 -11 516 1011)
   (ACCORDION.BAYANBASS -266 0 266 782) (ACCORDION.OLDEE -266 0 266 523)
   (ACCORDION.PUSH -230 0 0 575) (ACCORDION.PULL -192 0 38 575)
   (TIES.LYRIC.SHORT -178.471 -180 176.471 -85.1652)
   (TIES.LYRIC.DEFAULT -254.553 -186 252.313 -91.2112)
   (NOTEHEADS.UM2 -46 -177 468 705) (NOTEHEADS.DM2 -46 -768 468 177)
   (NOTEHEADS.SM1 -46 -177 468 177) (NOTEHEADS.SM1DOUBLE -123 -177 545 177)
   (NOTEHEADS.S0 0 -141 441 141) (NOTEHEADS.S1 0 -156 333 156)
   (NOTEHEADS.S2 0 -139 300 157) (NOTEHEADS.S0DIAMOND 0 -138 495 138)
   (NOTEHEADS.S1DIAMOND 0 -137 364 138) (NOTEHEADS.S2DIAMOND 0 -138 369 138)
   (NOTEHEADS.S0TRIANGLE 0 -219 579 183)
   (NOTEHEADS.D1TRIANGLE -1.0e-4 -197 418 165)
   (NOTEHEADS.U1TRIANGLE -1.0e-4 -197 418 165)
   (NOTEHEADS.U2TRIANGLE 0.39046 -197 348 165)
   (NOTEHEADS.D2TRIANGLE 0.39046 -197 348 165) (NOTEHEADS.S0SLASH 0 -263 754 263)
   (NOTEHEADS.S1SLASH 0 -263 586 263) (NOTEHEADS.S2SLASH 0 -263 429 263)
   (NOTEHEADS.S0CROSS 0 -150 429 150) (NOTEHEADS.S1CROSS 0 -144 379 144)
   (NOTEHEADS.S2CROSS 0 -138 329 138) (NOTEHEADS.S2XCIRCLE 0 -173 391 173)
   (NOTEHEADS.S0DO 0 -112 329 112) (NOTEHEADS.D1DO 0 -112 329 112)
   (NOTEHEADS.U1DO 0 -112 329 112) (NOTEHEADS.D2DO 0 -112 329 112)
   (NOTEHEADS.U2DO 0 -112 329 112) (NOTEHEADS.S0DOTHIN 0 -112 329 112)
   (NOTEHEADS.D1DOTHIN 0 -112 329 112) (NOTEHEADS.U1DOTHIN 0 -112 329 112)
   (NOTEHEADS.D2DOTHIN 0 -112 329 112) (NOTEHEADS.U2DOTHIN 0 -112 329 112)
   (NOTEHEADS.S0RE 0 -112 329 112) (NOTEHEADS.U1RE 0 -112 329 112)
   (NOTEHEADS.D1RE 0 -112 329 112) (NOTEHEADS.U2RE 0 -112 329 112)
   (NOTEHEADS.D2RE 0 -112 329 112) (NOTEHEADS.S0RETHIN 0 -112 329 112)
   (NOTEHEADS.U1RETHIN 0 -112 329 112) (NOTEHEADS.D1RETHIN 0 -112 329 112)
   (NOTEHEADS.U2RETHIN 0 -112 329 112) (NOTEHEADS.D2RETHIN 0 -112 329 112)
   (NOTEHEADS.S0MI 0 -112 395 112) (NOTEHEADS.S1MI 0 -112 395 112)
   (NOTEHEADS.S2MI 0 -112 395 112) (NOTEHEADS.S0MIMIRROR 0 -112 395 112)
   (NOTEHEADS.S1MIMIRROR 0 -112 395 112) (NOTEHEADS.S2MIMIRROR 0 -112 395 112)
   (NOTEHEADS.S0MITHIN 0 -112 395 112) (NOTEHEADS.S1MITHIN 0 -112 395 112)
   (NOTEHEADS.S2MITHIN 0 -112 395 112) (NOTEHEADS.U0FA 0 -112 329 113)
   (NOTEHEADS.D0FA 0 -113 329 112) (NOTEHEADS.U1FA 0 -112 329 113)
   (NOTEHEADS.D1FA 0 -113 329 112) (NOTEHEADS.U2FA 0 -112 329 113)
   (NOTEHEADS.D2FA 0 -113 329 112) (NOTEHEADS.U0FATHIN 0 -112 329 113)
   (NOTEHEADS.D0FATHIN 0 -113 329 112) (NOTEHEADS.U1FATHIN 0 -112 329 113)
   (NOTEHEADS.D1FATHIN 0 -113 329 112) (NOTEHEADS.U2FATHIN 0 -112 329 113)
   (NOTEHEADS.D2FATHIN 0 -113 329 112) (NOTEHEADS.S0SOL 0 -138 347 137)
   (NOTEHEADS.S1SOL 0 -138 347 137) (NOTEHEADS.S2SOL 0 -138 347 137)
   (NOTEHEADS.S0LA 0 -113 329 112) (NOTEHEADS.S1LA 0 -113 329 112)
   (NOTEHEADS.S2LA 0 -113 329 112) (NOTEHEADS.S0LATHIN 0 -113 329 112)
   (NOTEHEADS.S1LATHIN 0 -113 329 112) (NOTEHEADS.S2LATHIN 0 -113 329 112)
   (NOTEHEADS.S0TI 0 -112 329 112) (NOTEHEADS.U1TI 0 -112 329 112)
   (NOTEHEADS.D1TI 0 -112 329 112) (NOTEHEADS.U2TI 0 -112 329 112)
   (NOTEHEADS.D2TI 0 -112 329 112) (NOTEHEADS.S0TITHIN 0 -112 329 112)
   (NOTEHEADS.U1TITHIN 0 -112 329 112) (NOTEHEADS.D1TITHIN 0 -112 329 112)
   (NOTEHEADS.U2TITHIN 0 -112 329 112) (NOTEHEADS.D2TITHIN 0 -112 329 112)
   (NOTEHEADS.U0DOFUNK 0 -113 247 112) (NOTEHEADS.D0DOFUNK 0 -112 247 113)
   (NOTEHEADS.U1DOFUNK 0 -113 247 112) (NOTEHEADS.D1DOFUNK 0 -112 247 113)
   (NOTEHEADS.U2DOFUNK 0 -113 247 112) (NOTEHEADS.D2DOFUNK 0 -112 247 113)
   (NOTEHEADS.U0REFUNK 0 -112 247 112) (NOTEHEADS.D0REFUNK 0 -112 247 112)
   (NOTEHEADS.U1REFUNK 0 -112 247 112) (NOTEHEADS.D1REFUNK 0 -112 247 112)
   (NOTEHEADS.U2REFUNK 0 -112 247 112) (NOTEHEADS.D2REFUNK 0 -112 247 112)
   (NOTEHEADS.U0MIFUNK 0 -112 296 112) (NOTEHEADS.D0MIFUNK 0 -112 296 112)
   (NOTEHEADS.U1MIFUNK 0 -112 296 112) (NOTEHEADS.D1MIFUNK 0 -112 296 112)
   (NOTEHEADS.S2MIFUNK 0 -112 296 112) (NOTEHEADS.U0FAFUNK 0 -112 247 112)
   (NOTEHEADS.D0FAFUNK 0 -112 247 112) (NOTEHEADS.U1FAFUNK 0 -112 247 112)
   (NOTEHEADS.D1FAFUNK 0 -112 247 112) (NOTEHEADS.U2FAFUNK 0 -112 247 112)
   (NOTEHEADS.D2FAFUNK 0 -112 247 112) (NOTEHEADS.S0SOLFUNK 0 -112 240 112)
   (NOTEHEADS.S1SOLFUNK 0 -112 240 112) (NOTEHEADS.S2SOLFUNK 0 -112 240 112)
   (NOTEHEADS.S0LAFUNK 0 -113 247 112) (NOTEHEADS.S1LAFUNK 0 -113 247 112)
   (NOTEHEADS.S2LAFUNK 0 -113 247 112) (NOTEHEADS.U0TIFUNK 0 -113 247 113)
   (NOTEHEADS.D0TIFUNK 0 -113 247 113) (NOTEHEADS.U1TIFUNK 0 -113 247 113)
   (NOTEHEADS.D1TIFUNK 0 -113 247 113) (NOTEHEADS.U2TIFUNK 0 -113 247 113)
   (NOTEHEADS.D2TIFUNK 0 -113 247 113) (NOTEHEADS.S0DOWALKER 0 -112 247 112)
   (NOTEHEADS.U1DOWALKER 0 -112 247 112) (NOTEHEADS.D1DOWALKER 0 -112 247 112)
   (NOTEHEADS.U2DOWALKER 0 -112 247 112) (NOTEHEADS.D2DOWALKER 0 -112 247 112)
   (NOTEHEADS.S0REWALKER 0 -112 247 113) (NOTEHEADS.U1REWALKER 0 -113 247 112)
   (NOTEHEADS.D1REWALKER 0 -112 247 113) (NOTEHEADS.U2REWALKER 0 -113 247 112)
   (NOTEHEADS.D2REWALKER 0 -112 247 113) (NOTEHEADS.S0MIWALKER 0 -112 296 112)
   (NOTEHEADS.S1MIWALKER 0 -112 296 112) (NOTEHEADS.S2MIWALKER 0 -112 296 112)
   (NOTEHEADS.S0FAWALKER 0 -112 247 112) (NOTEHEADS.U1FAWALKER 0 -112 247 112)
   (NOTEHEADS.D1FAWALKER 0 -112 247 112) (NOTEHEADS.U2FAWALKER 0 -112 247 112)
   (NOTEHEADS.D2FAWALKER 0 -112 247 112) (NOTEHEADS.S0LAWALKER 0 -113 247 112)
   (NOTEHEADS.S1LAWALKER 0 -113 247 112) (NOTEHEADS.S2LAWALKER 0 -113 247 112)
   (NOTEHEADS.S0TIWALKER 0 -112 247 112) (NOTEHEADS.U1TIWALKER 0 -112 247 112)
   (NOTEHEADS.D1TIWALKER 0 -112 247 112) (NOTEHEADS.U2TIWALKER 0 -112 247 112)
   (NOTEHEADS.D2TIWALKER 0 -112 247 112) (FLAGS.U3 -16 -879.164 308 0)
   (FLAGS.U4 -16 -980.459 347 0) (FLAGS.U5 -16 -1284.41 291 0)
   (FLAGS.U6 -16 -1405.46 347 0) (FLAGS.U7 -16 -1743.16 347 0)
   (FLAGS.D3 -16 0 325 876.342) (FLAGS.D4 -16 -1.0e-4 324 956.978)
   (FLAGS.D5 -16 0 332 1276.64) (FLAGS.D6 -16 0 324 1376.98)
   (FLAGS.D7 -16 0 325 1601.98) (FLAGS.UGRACE -126.429 -478.818 255.249 -199.546)
   (FLAGS.DGRACE -126.429 199.546 255.249 478.818)
   (RESTS.M3NEOMENSURAL 0 -250 300 250) (RESTS.M2NEOMENSURAL 0 -250 100 250)
   (RESTS.M1NEOMENSURAL 0 0 100 250) (RESTS.0NEOMENSURAL 0 -156 100 0)
   (RESTS.1NEOMENSURAL 0 0 100 156) (RESTS.2NEOMENSURAL 0 0 200 200)
   (RESTS.3NEOMENSURAL 0 0 200 200) (RESTS.4NEOMENSURAL 0 0 200 250)
   (RESTS.M3MENSURAL 1 -260 74 510) (RESTS.M2MENSURAL 1 -260 74 260)
   (RESTS.M1MENSURAL 1 -10 74 260) (RESTS.0MENSURAL 1 -166 74 10)
   (RESTS.1MENSURAL 1 -10 74 166) (RESTS.2MENSURAL -25 -19 200 188)
   (RESTS.3MENSURAL 0 -19 200 188) (RESTS.4MENSURAL 0 -19 200 241)
   (CLEFS.VATICANA.DO -1.0e-6 -200 125.189 200)
   (CLEFS.VATICANA.DO_CHANGE -1.0e-6 -200 125.189 200)
   (CLEFS.VATICANA.FA -0.04 -375 262.48 200)
   (CLEFS.VATICANA.FA_CHANGE -0.04 -375 262.48 200)
   (CLEFS.MEDICAEA.DO 0 -375 250 375) (CLEFS.MEDICAEA.DO_CHANGE 0 -300 200 300)
   (CLEFS.MEDICAEA.FA 0 -375 425 375) (CLEFS.MEDICAEA.FA_CHANGE 0 -300 340 300)
   (CLEFS.NEOMENSURAL.C 0 -500 650 500)
   (CLEFS.NEOMENSURAL.C_CHANGE 0 -400 520 400) (CLEFS.PETRUCCI.C1 0 -350 250 800)
   (CLEFS.PETRUCCI.C1_CHANGE 0 -313 200 716) (CLEFS.PETRUCCI.C2 0 -600 250 800)
   (CLEFS.PETRUCCI.C2_CHANGE 0 -537 200 716) (CLEFS.PETRUCCI.C3 0 -800 250 800)
   (CLEFS.PETRUCCI.C3_CHANGE 0 -716 200 716) (CLEFS.PETRUCCI.C4 0 -800 250 600)
   (CLEFS.PETRUCCI.C4_CHANGE 0 -716 200 537) (CLEFS.PETRUCCI.C5 0 -800 250 350)
   (CLEFS.PETRUCCI.C5_CHANGE 0 -716 200 313) (CLEFS.MENSURAL.C 0 -550 285 550)
   (CLEFS.MENSURAL.C_CHANGE 0 -440 235 440)
   (CLEFS.BLACKMENSURAL.C 0 -550 285 550)
   (CLEFS.BLACKMENSURAL.C_CHANGE 0 -440 235 440)
   (CLEFS.PETRUCCI.F 0 -1125 517 625) (CLEFS.PETRUCCI.F_CHANGE 0 -900 414 500)
   (CLEFS.MENSURAL.F 0 -175 300 175) (CLEFS.MENSURAL.F_CHANGE 0 -140 240 140)
   (CLEFS.PETRUCCI.G -19.9999 -172 328 951)
   (CLEFS.PETRUCCI.G_CHANGE -16.0001 -138 262 761)
   (CLEFS.MENSURAL.G -19.9999 -172 328 951)
   (CLEFS.MENSURAL.G_CHANGE -16.0001 -138 262 761)
   (CLEFS.HUFNAGEL.DO -7.99997 -187 283 199)
   (CLEFS.HUFNAGEL.DO_CHANGE -5.99998 -149 226 159)
   (CLEFS.HUFNAGEL.FA -8 -324 283 262) (CLEFS.HUFNAGEL.FA_CHANGE -6 -259 226 209)
   (CLEFS.HUFNAGEL.DO.FA -8 -824 283 199)
   (CLEFS.HUFNAGEL.DO.FA_CHANGE -6 -759 226 159) (CLEFS.KIEVAN.DO 0 -563 367 138)
   (CLEFS.KIEVAN.DO_CHANGE 0 -563 367 138)
   (CUSTODES.HUFNAGEL.U0 -0.245553 -138 340 244)
   (CUSTODES.HUFNAGEL.U1 -0.245553 -138 428 369)
   (CUSTODES.HUFNAGEL.U2 -0.245553 -138 384 307)
   (CUSTODES.HUFNAGEL.D0 -0.245533 -244 340 138)
   (CUSTODES.HUFNAGEL.D1 -0.245533 -369 428 138)
   (CUSTODES.HUFNAGEL.D2 -0.245533 -307 384 138)
   (CUSTODES.MEDICAEA.U0 0 -138 69 250) (CUSTODES.MEDICAEA.U1 0 -138 69 375)
   (CUSTODES.MEDICAEA.U2 0 -138 69 312) (CUSTODES.MEDICAEA.D0 0 -250 69 138)
   (CUSTODES.MEDICAEA.D1 0 -375 69 138) (CUSTODES.MEDICAEA.D2 0 -312 69 138)
   (CUSTODES.VATICANA.U0 0 -85 66 250) (CUSTODES.VATICANA.U1 0 -85 66 375)
   (CUSTODES.VATICANA.U2 0 -85 66 313) (CUSTODES.VATICANA.D0 0 -250 66 85)
   (CUSTODES.VATICANA.D1 0 -375 66 85) (CUSTODES.VATICANA.D2 0 -312 66 85)
   (CUSTODES.MENSURAL.U0 0 -91.0001 680 500)
   (CUSTODES.MENSURAL.U1 0 -91.0001 768 625)
   (CUSTODES.MENSURAL.U2 0 -91.0001 724 562)
   (CUSTODES.MENSURAL.D0 -8.0e-5 -500 680 91.0001)
   (CUSTODES.MENSURAL.D1 -8.0e-5 -625 768 91.0001)
   (CUSTODES.MENSURAL.D2 -8.0e-5 -562 724 91.0001)
   (ACCIDENTALS.MEDICAEAM1 -6 -150 150 250)
   (ACCIDENTALS.VATICANAM1 -6 -98 131 228)
   (ACCIDENTALS.VATICANA0 -10 -190 110 190)
   (ACCIDENTALS.MENSURAL1 -90 -110 140 110)
   (ACCIDENTALS.MENSURALM1 -13 -91 132 463)
   (ACCIDENTALS.HUFNAGELM1 -21.9999 -96.1396 147 472)
   (ACCIDENTALS.KIEVAN1 -5 -424 411 431) (ACCIDENTALS.KIEVANM1 4 -266 225 443)
   (FLAGS.MENSURALU03 -16 -495 151 0) (FLAGS.MENSURALU13 -16 -370 125 0)
   (FLAGS.MENSURALU23 -16 -445 150 0) (FLAGS.MENSURALD03 -167 0 0 495)
   (FLAGS.MENSURALD13 -141 0 0 370) (FLAGS.MENSURALD23 -167 0 0 445)
   (FLAGS.MENSURALU04 -19 -749 151 0) (FLAGS.MENSURALU14 -19 -624 125 0)
   (FLAGS.MENSURALU24 -19 -686 150 0) (FLAGS.MENSURALD04 -167 0 3.00003 749)
   (FLAGS.MENSURALD14 -141 0 3.00003 624) (FLAGS.MENSURALD24 -167 0 3 686)
   (FLAGS.MENSURALU05 -19 -999 151 0) (FLAGS.MENSURALU15 -19 -874 125 0)
   (FLAGS.MENSURALU25 -19 -936 150 0) (FLAGS.MENSURALD05 -167 0 3.00003 999)
   (FLAGS.MENSURALD15 -141 0 3.00003 874) (FLAGS.MENSURALD25 -167 0 3 936)
   (FLAGS.MENSURALU06 -19 -1249 151 0) (FLAGS.MENSURALU16 -19 -1124 125 0)
   (FLAGS.MENSURALU26 -19 -1186 150 0) (FLAGS.MENSURALD06 -167 0 3.00003 1249)
   (FLAGS.MENSURALD16 -141 0 3.00003 1124) (FLAGS.MENSURALD26 -167 0 3 1186)
   (TIMESIG.MENSURAL44 0 -194 370 194) (TIMESIG.MENSURAL22 0 -319 370 319)
   (TIMESIG.MENSURAL32 0 -194 425.007 194) (TIMESIG.MENSURAL64 0 -194 370 194)
   (TIMESIG.MENSURAL94 0 -194 425.007 194)
   (TIMESIG.MENSURAL34 0 -319 425.008 319) (TIMESIG.MENSURAL68 0 -319 370 319)
   (TIMESIG.MENSURAL98 0 -319 425.008 319) (TIMESIG.MENSURAL48 55 -194 425 194)
   (TIMESIG.MENSURAL68ALT 55 -194 425 194) (TIMESIG.MENSURAL24 55 -319 425 319)
   (TIMESIG.NEOMENSURAL44 0 -213 370 213) (TIMESIG.NEOMENSURAL22 0 -213 370 213)
   (TIMESIG.NEOMENSURAL32 0 -213 425 213) (TIMESIG.NEOMENSURAL64 0 -213 370 213)
   (TIMESIG.NEOMENSURAL94 0 -213 425 213) (TIMESIG.NEOMENSURAL34 0 -213 425 213)
   (TIMESIG.NEOMENSURAL68 0 -213 370 213) (TIMESIG.NEOMENSURAL98 0 -213 425 213)
   (TIMESIG.NEOMENSURAL48 55 -213 425 213)
   (TIMESIG.NEOMENSURAL68ALT 55 -213 425 213)
   (TIMESIG.NEOMENSURAL24 55 -213 425 213) (SCRIPTS.ICTUS -13 -44 13 44)
   (SCRIPTS.UACCENTUS -31 -44 31 44) (SCRIPTS.DACCENTUS -31 -44 31 44)
   (SCRIPTS.USEMICIRCULUS -39 0 39 39) (SCRIPTS.DSEMICIRCULUS -39 -39 39 0)
   (SCRIPTS.CIRCULUS -39 -39 39 39) (SCRIPTS.AUGMENTUM -31 -31 31 31)
   (SCRIPTS.USIGNUMCONGRUENTIAE -164 -52 163 571)
   (SCRIPTS.DSIGNUMCONGRUENTIAE -163 -571 164 52)
   (SCRIPTS.BARLINE.KIEVAN -2 -512 380 709) (DOTS.DOTVATICANA 0 -38 75 38)
   (DOTS.DOTKIEVAN 0 -112 225 112) (NOTEHEADS.UM3NEOMENSURAL 0 -195 670 448)
   (NOTEHEADS.DM3NEOMENSURAL 0 -448 670 195)
   (NOTEHEADS.UM2NEOMENSURAL 0 -195 520 448)
   (NOTEHEADS.DM2NEOMENSURAL 0 -448 520 195)
   (NOTEHEADS.SM1NEOMENSURAL 0 -195 500 195)
   (NOTEHEADS.URM3NEOMENSURAL 0 -195 670 448)
   (NOTEHEADS.DRM3NEOMENSURAL 0 -448 670 195)
   (NOTEHEADS.URM2NEOMENSURAL 0 -195 520 448)
   (NOTEHEADS.DRM2NEOMENSURAL 0 -448 520 195)
   (NOTEHEADS.SRM1NEOMENSURAL 0 -195 500 195)
   (NOTEHEADS.S0NEOMENSURAL 0 -138 250 138)
   (NOTEHEADS.S1NEOMENSURAL 0 -138 250 138)
   (NOTEHEADS.S2NEOMENSURAL 0 -138 250 138)
   (NOTEHEADS.S0HARMONIC 0 -179 330 175.004)
   (NOTEHEADS.S2HARMONIC 0 -179 330 175.004)
   (NOTEHEADS.UM3MENSURAL 0 -195 508 633) (NOTEHEADS.DM3MENSURAL 0 -632 508 195)
   (NOTEHEADS.SM3LIGMENSURAL 0 -195 500 195)
   (NOTEHEADS.UM2MENSURAL 0 -195 258 633) (NOTEHEADS.DM2MENSURAL 0 -632 258 195)
   (NOTEHEADS.SM2LIGMENSURAL 0 -633 250 195)
   (NOTEHEADS.SM1MENSURAL 0 -195 250 195) (NOTEHEADS.URM3MENSURAL 0 -195 508 633)
   (NOTEHEADS.DRM3MENSURAL 0 -633 508 195)
   (NOTEHEADS.SRM3LIGMENSURAL 0 -195 500 195)
   (NOTEHEADS.URM2MENSURAL 0 -195 258 633)
   (NOTEHEADS.DRM2MENSURAL 0 -633 258 195)
   (NOTEHEADS.SRM2LIGMENSURAL 0 -633 250 195)
   (NOTEHEADS.SRM1MENSURAL 0 -195 250 195)
   (NOTEHEADS.UM3SEMIMENSURAL 0 -195 508 633)
   (NOTEHEADS.DM3SEMIMENSURAL 0 -632 508 195)
   (NOTEHEADS.SM3SEMILIGMENSURAL 0 -195 500 195)
   (NOTEHEADS.UM2SEMIMENSURAL 0 -195 258 633)
   (NOTEHEADS.DM2SEMIMENSURAL 0 -632 258 195)
   (NOTEHEADS.SM2SEMILIGMENSURAL 0 -633 250 195)
   (NOTEHEADS.SM1SEMIMENSURAL 0 -195 250 195)
   (NOTEHEADS.URM3SEMIMENSURAL 0 -195 508 633)
   (NOTEHEADS.DRM3SEMIMENSURAL 0 -633 508 195)
   (NOTEHEADS.SRM3SEMILIGMENSURAL 0 -195 500 195)
   (NOTEHEADS.URM2SEMIMENSURAL 0 -195 258 633)
   (NOTEHEADS.DRM2SEMIMENSURAL 0 -633 258 195)
   (NOTEHEADS.SRM2SEMILIGMENSURAL 0 -633 250 195)
   (NOTEHEADS.SRM1SEMIMENSURAL 0 -195 250 195)
   (NOTEHEADS.UM3BLACKMENSURAL 0 -195 508 633)
   (NOTEHEADS.DM3BLACKMENSURAL 0 -633 508 195)
   (NOTEHEADS.SM3BLACKLIGMENSURAL 0 -195 500 195)
   (NOTEHEADS.UM2BLACKMENSURAL 0 -195 258 633)
   (NOTEHEADS.DM2BLACKMENSURAL 0 -633 258 195)
   (NOTEHEADS.SM2BLACKLIGMENSURAL 0 -633 250 195)
   (NOTEHEADS.SM1BLACKMENSURAL 0 -195 250 195)
   (NOTEHEADS.S0MENSURAL 0 -125 144 125) (NOTEHEADS.S1MENSURAL 0 -125 144 125)
   (NOTEHEADS.S2MENSURAL 0 -125 144 125)
   (NOTEHEADS.S0BLACKMENSURAL 0 -125 144 125)
   (NOTEHEADS.S0PETRUCCI 0 -192 277 192) (NOTEHEADS.S1PETRUCCI 0 -192 277 192)
   (NOTEHEADS.S2PETRUCCI 0 -192 277 192)
   (NOTEHEADS.S0BLACKPETRUCCI 0 -192 277 192)
   (NOTEHEADS.S1BLACKPETRUCCI 0 -192 277 192)
   (NOTEHEADS.S2BLACKPETRUCCI 0 -192 277 192)
   (NOTEHEADS.SVATICANA.PUNCTUM 0 -81 139 87)
   (NOTEHEADS.SVATICANA.PUNCTUM.CAVUM 0 -81 139 87)
   (NOTEHEADS.SVATICANA.LINEA.PUNCTUM 0 -96 220 96)
   (NOTEHEADS.SVATICANA.LINEA.PUNCTUM.CAVUM 0 -96 220 96)
   (NOTEHEADS.SVATICANA.INCLINATUM 0 -110 154 110)
   (NOTEHEADS.SVATICANA.LPES 0 -79.5556 139 78)
   (NOTEHEADS.SVATICANA.VLPES 0 -109.556 139 48)
   (NOTEHEADS.SVATICANA.UPES 0 -78 139 79.5556)
   (NOTEHEADS.SVATICANA.VUPES 0 -56 139 101.556)
   (NOTEHEADS.SVATICANA.PLICA 0 -53 83 57)
   (NOTEHEADS.SVATICANA.VPLICA 0 -74 83 49)
   (NOTEHEADS.SVATICANA.EPIPHONUS 0 -93 139 115)
   (NOTEHEADS.SVATICANA.VEPIPHONUS 0 -123 139 85)
   (NOTEHEADS.SVATICANA.REVERSE.PLICA 0 -57 83 53)
   (NOTEHEADS.SVATICANA.REVERSE.VPLICA 0 -85 83 37)
   (NOTEHEADS.SVATICANA.INNER.CEPHALICUS 0 -115 139 93)
   (NOTEHEADS.SVATICANA.CEPHALICUS 0 -315 139 93)
   (NOTEHEADS.SVATICANA.QUILISMA 0 -99 139 99)
   (NOTEHEADS.SSOLESMES.INCL.PARVUM 0 -69 96 69)
   (NOTEHEADS.SSOLESMES.AUCT.ASC 0 -83 139 148)
   (NOTEHEADS.SSOLESMES.AUCT.DESC 0 -148 139 83)
   (NOTEHEADS.SSOLESMES.INCL.AUCTUM -13 -122 154 110)
   (NOTEHEADS.SSOLESMES.STROPHA 6 -110 154 110)
   (NOTEHEADS.SSOLESMES.STROPHA.AUCTA -13 -125 154 110)
   (NOTEHEADS.SSOLESMES.ORISCUS 0 -83 165 83)
   (NOTEHEADS.SMEDICAEA.INCLINATUM 0 -150 210 150)
   (NOTEHEADS.SMEDICAEA.PUNCTUM 0 -125 200 125)
   (NOTEHEADS.SMEDICAEA.RVIRGA 0 -125 200 625)
   (NOTEHEADS.SMEDICAEA.VIRGA 0 -625 200 125)
   (NOTEHEADS.SHUFNAGEL.PUNCTUM 0 -125 357 125)
   (NOTEHEADS.SHUFNAGEL.VIRGA 0 -375 357 125)
   (NOTEHEADS.SHUFNAGEL.LPES 0 -100 500 100) (NOTEHEADS.SM2KIEVAN 0 -376 325 376)
   (NOTEHEADS.SM1KIEVAN 0 -226 1300 225) (NOTEHEADS.S0KIEVAN 0 -250 250 250)
   (NOTEHEADS.D2KIEVAN 0 -622 255 93) (NOTEHEADS.U2KIEVAN 0 -93 255 647)
   (NOTEHEADS.S1KIEVAN 0 -391 265 236) (NOTEHEADS.SR1KIEVAN 0 -292 268 356)
   (NOTEHEADS.D3KIEVAN 0 -750 315 104) (NOTEHEADS.U3KIEVAN 0 -93 255 706)
   (SPACE 0 0 0 0) (PLUS 0 69.4705 361.059 430.529)
   (COMMA -6.0e-5 -127.189 156 142) (HYPHEN 0 215 361.059 287)
   (PERIOD 0 0 114 114) (ZERO -0.00938 -3.00581 408.01 497.006)
   (ONE -0.16637 -0.279529 304.5 507.75) (TWO -8.0e-5 0 413 509)
   (THREE -0.711095 -6.14785 390.056 501.147) (FOUR 0.365179 1.4e-5 407 513.472)
   (FIVE -0.185201 -4.58486 380.211 500.02)
   (SIX -0.840688 -4.49473 373.536 496.354)
   (SEVEN -0.872371 -3.28763 421.361 501.851) (EIGHT 0 -8 377 507)
   (NINE -0.536435 1.646 373.841 502.495) (F -122 -157 407 501)
   (M -53.349 -14.1291 471.407 326) (P -119.983 -107 363 319)
   (R -31.4009 0 296 306) (S 0 0 324 305) (Z -79.3229 -5.41156 259.679 298)))
clefs.G [-15.9997,-664,632,1114.43]
clefs.F [-84.1666,-579.275,699,250]
 clefs.C [-2.63826,-504.501,669,503.386] 
(defparameter *fnt*
  ((name bbx d)))


(flet ((resolver (pubid sysid)
		     (declare (ignore pubid sysid))
		     (flexi-streams:make-in-memory-input-stream nil)))
	      (second (second (second (fourth (fourth (cxml:parse-file "/tmp/SMT-GClef.svg"
								       (cxml-xmls:make-xmls-builder)
								       :entity-resolver #'resolver)))))))
